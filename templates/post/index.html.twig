{% extends 'base.html.twig' %}

{% block body %}
    <h1>Toutes les actualités</h1>
    <form method="get">
        <input type="text" name="search" placeholder="Recherche par mot clé">
        <button type="submit">Recherche</button>
    </form>
    <ul>
        {% for post in posts %}
            <li>
                <a href="{{ path('post_show', {'id': post.id}) }}">{{ post.title }}</a>
                <div>
                    <span>{{ post.countLikes() }} likes</span>
                    <span>{{ post.countDislikes() }} dislikes</span>
                </div>
                <p>
                    {% if post.content|length > 500 %}
                        {{ post.content[:500] ~ '...' }}
                    {% else %}
                        {{ post.content }}
                    {% endif %}
                    <a href="{{ path('post_show', {'id': post.id}) }}">lire la suite</a>
                </p>
                {% if is_granted('ROLE_ADMIN') %}
                    <a href="{{ path('admin_post_edit', {'id': post.id}) }}">Modifier</a>
                {% endif %}
            </li>
        {% endfor %}
    </ul>
{% endblock %}